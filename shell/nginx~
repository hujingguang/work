#!/bin/bash
. /etc/rc.d/init.d/functions
. /etc/sysconfig/network
[ "$NETWORKING" = "no" ] && exit 0
nginx="/webdata/opt/local/tengine/sbin/nginx"
prog=$(basename $nginx)
NGINX_CONF_FILE="/webdata/opt/local/tengine/conf/nginx.conf"
lockfile=/var/lock/subsys/nginx.lock
nginx_pid="/webdata/opt/local/tengine/logs/nginx.pid"
start() {
[ -x $nginx ] || exit 5
[ -f $NGINX_CONF_FILE ] || exit 6
echo -n $"Starting $prog: "
#daemon $nginx -c $NGINX_CONF_FILE

daemon --pidfile $nginx_pid $nginx -c $NGINX_CONF_FILE

retval=$?
[ $retval -eq 0 ] && touch $lockfile
return $retval

}

stop() {
echo -n $"Stopping $prog: "
killproc -p $nginx_pid $prog
retval=$?
[ $retval -eq 0 ] && rm -f $lockfile
return $retval

}
restart() {
stop
start
}
reload() {
echo -n $"Reloading $prog: "
$nginx -s reload
RETVAL=$?
return $RETVAL
}
nginx_status() {
status $prog
}
case "$1" in
start)
start
;;
stop)
stop
;;
restart)
restart
;;
reload)
reload
;;
status)
nginx_status
;;
*)
echo $"Usage: $0 {start|stop|status|restart|reload}"
exit 2
esac
